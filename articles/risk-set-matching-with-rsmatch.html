<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rsmatch">
<title>Risk Set Matching with rsmatch • rsmatch</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Risk Set Matching with rsmatch">
<meta property="og:description" content="rsmatch">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rsmatch</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/risk-set-matching-with-rsmatch.html">Risk Set Matching with rsmatch</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/skent259/rsmatch/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Risk Set Matching with rsmatch</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/skent259/rsmatch/blob/HEAD/vignettes/risk-set-matching-with-rsmatch.Rmd" class="external-link"><code>vignettes/risk-set-matching-with-rsmatch.Rmd</code></a></small>
      <div class="d-none name"><code>risk-set-matching-with-rsmatch.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="time-varying-matching">Time-varying matching<a class="anchor" aria-label="anchor" href="#time-varying-matching"></a>
</h2>
<p>Any time we are handling observational data (as opposed to that from
a randomized study) and trying to measure the effect of some treatment,
bias can potentially confound our estimates—undermining the analysis. To
reduce this bias, <em>matching</em> attempts to find groups that are
similar across measured variables, despite receiving alternate sides of
treatment. Matching requires special care when treatment(s) (and related
matching variables) happen at multiple multiple times, as in some
longitudinal data.</p>
<p>The R package <strong>rsmatch</strong> implements various forms of
matching on time-varying observational studies to help in causal
inference.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://skent259.github.io/rsmatch/">rsmatch</a></span><span class="op">)</span></span></code></pre></div>
<p>This short vignette aims to provide enough information on
time-varying matching and the rsmatch package for someone to start data
analysis. The package implements two different approaches, and we
recommend a thorough read-through of the corresponding paper to
understand the methodology, potential pitfalls, and other crucial
considerations.</p>
<ul>
<li>
<strong>Balanced Risk Set Matching</strong> with
<code><a href="../reference/brsmatch.html">brsmatch()</a></code>, based on the work of Li, Propert, and Rosenbaum
(2001)</li>
<li>
<strong>Propensity Score Matching with Time-Dependent
Covariates</strong> with <code>coxph_match()</code>, based on the work
of Lu (2005)</li>
</ul>
</div>
<div class="section level2">
<h2 id="oasis-data">OASIS data<a class="anchor" aria-label="anchor" href="#oasis-data"></a>
</h2>
<p>We start by showing a data set that can illustrate the structure of a
time-varying observational data set.</p>
<p>Consider the <code>oasis</code> data with 51 patients from the <a href="https://www.oasis-brains.org/" class="external-link">Open Access Series of Imaging
Studies</a> that are classified at each time point as having Alzheimer’s
disease (AD) or not.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oasis</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">oasis</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    subject_id visit time_of_ad m_f educ ses age mr_delay e_tiv n_wbv   asf</span></span>
<span><span class="co">#&gt; 1   OAS2_0002     1         NA   M   12  -1  75        0  1678 0.736 1.046</span></span>
<span><span class="co">#&gt; 2   OAS2_0002     2         NA   M   12  -1  76      560  1738 0.713 1.010</span></span>
<span><span class="co">#&gt; 3   OAS2_0002     3         NA   M   12  -1  80     1895  1698 0.701 1.034</span></span>
<span><span class="co">#&gt; 4   OAS2_0007     1          3   M   16  -1  71        0  1357 0.748 1.293</span></span>
<span><span class="co">#&gt; 5   OAS2_0007     3          3   M   16  -1  73      518  1365 0.727 1.286</span></span>
<span><span class="co">#&gt; 6   OAS2_0007     4          3   M   16  -1  75     1281  1372 0.710 1.279</span></span>
<span><span class="co">#&gt; 7   OAS2_0009     1         NA   M   12   2  68        0  1457 0.806 1.205</span></span>
<span><span class="co">#&gt; 8   OAS2_0009     2         NA   M   12   2  69      576  1480 0.791 1.186</span></span>
<span><span class="co">#&gt; 9   OAS2_0010     1         NA   F   12   3  66        0  1447 0.769 1.213</span></span>
<span><span class="co">#&gt; 10  OAS2_0010     2         NA   F   12   3  68      854  1482 0.752 1.184</span></span></code></pre></div>
<p>The data set has been modified to a “long” time-varying format with
the following variables:</p>
<ul>
<li>
<code>subject_id</code> - A unique patient identifier</li>
<li>
<code>visit</code> - An identifier of the time point, from 1 up to
4</li>
<li>
<code>time_of_ad</code> - The visit in which a patient was
identified to have AD, or NA if this patient has not yet been identified
with AD</li>
<li>
<code>m_f</code>, <code>educ</code>,<code>ses</code>,
<code>age</code> - Baseline patient characteristics for gender,
education level, socioeconomic status, age</li>
<li>
<code>mr_delay</code>, <code>e_tiv</code>, <code>n_wbv</code>,
<code>asf</code> - Time-varying patient characteristics for MR delay
time, estimated total intracranial volume, and Atlas scaling
factor.</li>
</ul>
<p>Importantly, visits have a similar time difference between them. This
sets up a panel data structure. The package does not help with data sets
where subject visits happen irregularly or continuously.</p>
<p>This data set illustrates a few of the standard causal inference
elements for time-varying matching, including</p>
<ul>
<li>
<strong>Treatment</strong>: The “treatment” used here is being
diagnosed with AD, with the associated cognitive changes. NOTE: this is
far from the standard concept of treatment in a randomized study, but we
could be interested in the effect of a diagnosis of AD on other
variables like mortality, health care cost, or time spent with loved
ones.</li>
<li>
<strong>Control groups across time</strong>: For visit <span class="math inline">\(t\)</span>, the control group includes all
subjects without AD yet. For example, the control group at visit 1
includes all patients. The control group at visit 3 would include
OAS2_0002, OAS2_0009, and OAS2_0010 above, but would NOT include
OAS2_0007 (who has AD at that visit).</li>
<li>
<strong>Treatment groups across time</strong>: For visit <span class="math inline">\(t\)</span>, the treatment group includes all
subjects diagnosed with AD at that visit. Subject OAS2_0007 is in the
treatment group at visit 3, but NOT in the treatment groups for visits
1, 2, or 4.</li>
<li>
<strong>Matching (confounding) variables</strong>: Variables that
relate to both the treatment (AD) and the chosen outcome. This includes
both baseline characteristics and time-varying characters.</li>
</ul>
<p>Unfortunately, the data is missing a key aspect for causal analysis,
the <strong>outcome</strong> on which to measure our treatment effect.
Open-source longitudinal data sets are somewhat scarce, and this was the
most illustrative example we could find while including in the package.
However, this data fully demonstrates the matching process. Applying a
set of matches to determine the treatment effect is, thankfully, a
typically straightforward process.</p>
<p>Our goal is to match subjects similar in their gender, education
level, socioeconomic status, age, and other MRI measurements, but one of
which moved from a cognitively normal state to AD in the next period and
the other who remained cognitively normal. On these similar groups, we
can hopefully isolate the effect of an AD diagnosis on an outcome of
interest.</p>
</div>
<div class="section level2">
<h2 id="balanced-risk-set-matching">Balanced Risk Set Matching<a class="anchor" aria-label="anchor" href="#balanced-risk-set-matching"></a>
</h2>
<p>Based on the work of Li et al. (2001), the <code><a href="../reference/brsmatch.html">brsmatch()</a></code>
function performs “Balanced Risk Set Matching”. Given our data
structure, it finds matches based on minimizing the Mahalanobis distance
between covariates. If balancing is desired, the model will try to
minimize the imbalance in terms of specified balancing covariates in the
final pair output. Each treated individual is matched to one other
individual. Full details are provided in the available reference.</p>
<p>For example, we can find 5 matched pairs based on all covariates with
balance across gender and age:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brsmatch.html">brsmatch</a></span><span class="op">(</span></span>
<span>  n_pairs <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  data <span class="op">=</span> <span class="va">oasis</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"subject_id"</span>, </span>
<span>  time <span class="op">=</span> <span class="st">"visit"</span>, </span>
<span>  trt_time <span class="op">=</span> <span class="st">"time_of_ad"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m_f"</span>, <span class="st">"educ"</span>, <span class="st">"ses"</span>, <span class="st">"age"</span>, </span>
<span>                 <span class="st">"mr_delay"</span>, <span class="st">"e_tiv"</span>, <span class="st">"n_wbv"</span>, <span class="st">"asf"</span><span class="op">)</span>,</span>
<span>  balance <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  balance_covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m_f"</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span></span>
<span><span class="co">#&gt;    subject_id pair_id type</span></span>
<span><span class="co">#&gt; 5   OAS2_0014       1  trt</span></span>
<span><span class="co">#&gt; 15  OAS2_0043       2  all</span></span>
<span><span class="co">#&gt; 22  OAS2_0079       2  trt</span></span>
<span><span class="co">#&gt; 32  OAS2_0112       3  all</span></span>
<span><span class="co">#&gt; 36  OAS2_0124       1  all</span></span>
<span><span class="co">#&gt; 40  OAS2_0140       5  all</span></span>
<span><span class="co">#&gt; 41  OAS2_0150       3  trt</span></span>
<span><span class="co">#&gt; 43  OAS2_0160       4  trt</span></span>
<span><span class="co">#&gt; 49  OAS2_0182       4  all</span></span>
<span><span class="co">#&gt; 50  OAS2_0184       5  trt</span></span></code></pre></div>
<p>The output includes a long-format data frame with
<code>subject_id</code>, <code>pair_id</code>, and <code>type</code> to
indicate whether the subject was considered in the treatment
(<code>trt</code>) group, or the control (<code>all</code>) group for
the indicated time point. The <code>type</code> variable is helpful
because subjects who got AD could match in either the treatment or
control group depending on which visit they were matched in.
<code><a href="../reference/brsmatch.html">brsmatch()</a></code> considers all of the possibilities in finding an
optimal match. The output will include all subjects, with an
<code>NA</code> value for <code>pair_id</code> and <code>type</code> for
unmatched subjects.</p>
<p>Taking, for example, the first pair, OAS2_0014 to OAS2_0124, we know
that the matching happened at visit 2, and in that visit, the two
subjects have very similar covariates.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_pair</span> <span class="op">&lt;-</span> <span class="va">pairs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">$</span><span class="va">pair_id</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, <span class="st">"subject_id"</span><span class="op">]</span></span>
<span><span class="va">oasis</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">oasis</span><span class="op">$</span><span class="va">subject_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">first_pair</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;    subject_id visit time_of_ad m_f educ ses age mr_delay e_tiv n_wbv   asf</span></span>
<span><span class="co">#&gt; 11  OAS2_0014     1          2   M   16   3  76        0  1602 0.697 1.096</span></span>
<span><span class="co">#&gt; 12  OAS2_0014     2          2   M   16   3  77      504  1590 0.696 1.104</span></span>
<span><span class="co">#&gt; 80  OAS2_0124     1         NA   M   16   3  70        0  1463 0.749 1.200</span></span>
<span><span class="co">#&gt; 81  OAS2_0124     2         NA   M   16   3  71      472  1479 0.750 1.187</span></span></code></pre></div>
<p>Full details of the <code><a href="../reference/brsmatch.html">brsmatch()</a></code> function’s arguments can
be found with <code><a href="../reference/brsmatch.html">?brsmatch</a></code>. One option not used in this
example allows for exact matching constraints. These can be very useful
to improve the optimization speed for large data sets.</p>
</div>
<div class="section level2">
<h2 id="propensity-score-matching-with-time-dependent-covariates">Propensity Score Matching with Time-Dependent Covariates<a class="anchor" aria-label="anchor" href="#propensity-score-matching-with-time-dependent-covariates"></a>
</h2>
<p>Based on the work of Lu (2005) “Propensity Score Matching with
Time-Dependent Covariates”, the <code><a href="../reference/coxpsmatch.html">coxpsmatch()</a></code> function
matches subjects based on time-dependent propensity scores from a Cox
proportional hazards model. If balancing is desired, the model will try
to minimize the imbalance in terms of specified balancing covariates in
the final pair output. Each treated individual is matched to one other
individual.</p>
<p>The <code><a href="../reference/coxpsmatch.html">coxpsmatch()</a></code> interface is similar to
<code><a href="../reference/brsmatch.html">brsmatch()</a></code> in both inputs and outputs as the following
example shows. However, <code><a href="../reference/coxpsmatch.html">coxpsmatch()</a></code> can pair all
individuals if desired and does not allow (or need) the option of
separate balance variables.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coxpsmatch.html">coxpsmatch</a></span><span class="op">(</span></span>
<span>  n_pairs <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  data <span class="op">=</span> <span class="va">oasis</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"subject_id"</span>, </span>
<span>  time <span class="op">=</span> <span class="st">"visit"</span>, </span>
<span>  trt_time <span class="op">=</span> <span class="st">"time_of_ad"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m_f"</span>, <span class="st">"educ"</span>, <span class="st">"ses"</span>, <span class="st">"age"</span>, </span>
<span>                 <span class="st">"mr_delay"</span>, <span class="st">"e_tiv"</span>, <span class="st">"n_wbv"</span>, <span class="st">"asf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span></span>
<span><span class="co">#&gt;    subject_id pair_id type</span></span>
<span><span class="co">#&gt; 3   OAS2_0009       1  all</span></span>
<span><span class="co">#&gt; 5   OAS2_0014       2  trt</span></span>
<span><span class="co">#&gt; 16  OAS2_0046       1  trt</span></span>
<span><span class="co">#&gt; 29  OAS2_0104       5  trt</span></span>
<span><span class="co">#&gt; 32  OAS2_0112       5  all</span></span>
<span><span class="co">#&gt; 34  OAS2_0114       4  trt</span></span>
<span><span class="co">#&gt; 36  OAS2_0124       2  all</span></span>
<span><span class="co">#&gt; 39  OAS2_0139       4  all</span></span>
<span><span class="co">#&gt; 41  OAS2_0150       3  trt</span></span>
<span><span class="co">#&gt; 49  OAS2_0182       3  all</span></span></code></pre></div>
<p>In this example, OAS2_0014 still matches to OAS2_0124, but other
matches differ.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">second_pair</span> <span class="op">&lt;-</span> <span class="va">pairs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">$</span><span class="va">pair_id</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"subject_id"</span><span class="op">]</span></span>
<span><span class="va">oasis</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">oasis</span><span class="op">$</span><span class="va">subject_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">second_pair</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 11</span></span></span>
<span><span class="co">#&gt;   subject_id visit time_of_ad m_f    educ ses     age mr_delay e_tiv n_wbv   asf</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> OAS2_0014      1          2 M        16 3        76        0  <span style="text-decoration: underline;">1</span>602 0.697  1.10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> OAS2_0014      2          2 M        16 3        77      504  <span style="text-decoration: underline;">1</span>590 0.696  1.10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> OAS2_0124      1         <span style="color: #BB0000;">NA</span> M        16 3        70        0  <span style="text-decoration: underline;">1</span>463 0.749  1.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> OAS2_0124      2         <span style="color: #BB0000;">NA</span> M        16 3        71      472  <span style="text-decoration: underline;">1</span>479 0.75   1.19</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="going-further">Going further<a class="anchor" aria-label="anchor" href="#going-further"></a>
</h2>
<p>This quick vignette provides a primer to get you started with
time-varying matching methods. Some necessary concepts not covered
include:</p>
<ul>
<li>How to select which variables to include for matching, balancing,
and exact matches</li>
<li>How to visualize and quantify whether the matches are good</li>
<li>How to use the matches to compare the outcome (e.g. binary,
continuous, or survival endpoints)</li>
<li>Sensitivity analysis to measure the size of an unmeasured confounder
that could change your treatment-effect conclusions</li>
<li>Whether treatment occurs at the specified visit, or in between two
visits (see the <code>time_lag</code> option in both functions)</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Li, Yunfei Paul, Kathleen J Propert, and Paul R Rosenbaum. 2001.
“Balanced Risk Set Matching.” Journal of the American Statistical
Association 96 (455): 870–82.</p>
<p>Lu, Bo. 2005. “Propensity Score Matching with Time-Dependent
Covariates.” Biometrics 61 (3): 721–28.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/skent259" class="external-link">Sean Kent</a>, Mitchell Paukner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
