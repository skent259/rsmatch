<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content='Implements popular methods for matching in time-varying
    observational studies. Matching is difficult in this scenario because
    participants can be treated at different times which may have an
    influence on the outcomes. The core methods include: "Balanced Risk
    Set Matching" from Li, Propert, and Rosenbaum (2011)
    &lt;doi:10.1198/016214501753208573&gt; and "Propensity Score Matching with
    Time-Dependent Covariates" from Lu (2005)
    &lt;doi:10.1111/j.1541-0420.2005.00356.x&gt;. Some functions use the
    Gurobi optimization back-end to improve the optimization problem
    speed; the gurobi R package and associated software can be
    downloaded from &lt;https://www.gurobi.com&gt; after obtaining a license.'>
<title>Matching Methods for Time-Varying Observational Studies • rsmatch</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Matching Methods for Time-Varying Observational Studies">
<meta property="og:description" content='Implements popular methods for matching in time-varying
    observational studies. Matching is difficult in this scenario because
    participants can be treated at different times which may have an
    influence on the outcomes. The core methods include: "Balanced Risk
    Set Matching" from Li, Propert, and Rosenbaum (2011)
    &lt;doi:10.1198/016214501753208573&gt; and "Propensity Score Matching with
    Time-Dependent Covariates" from Lu (2005)
    &lt;doi:10.1111/j.1541-0420.2005.00356.x&gt;. Some functions use the
    Gurobi optimization back-end to improve the optimization problem
    speed; the gurobi R package and associated software can be
    downloaded from &lt;https://www.gurobi.com&gt; after obtaining a license.'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">rsmatch</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/risk-set-matching-with-rsmatch.html">Risk Set Matching with rsmatch</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/skent259/rsmatch/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rsmatch">rsmatch<a class="anchor" aria-label="anchor" href="#rsmatch"></a>
</h1></div>
<!-- badges: start -->

<p>The R package rsmatch implements various forms of <strong>matching on time-varying observational studies</strong> to help in causal inference. The package utilized the idea of matching through a series of risk sets consisting of all subjects who are still “at risk” of treatment. Subjects in this set treated at the next time point can be matched to controls who are not treated to avoid bias in estimating treatment effects.</p>
<p>Currently, we have methods for:</p>
<ul>
<li>
<strong>Balanced Risk Set Matching</strong> with <code><a href="reference/brsmatch.html">brsmatch()</a></code>, based on the work of Li, Propert, and Rosenbaum (2001)</li>
<li>
<strong>Propensity Score Matching with Time-Dependent Covariates</strong> with <code><a href="reference/coxpsmatch.html">coxpsmatch()</a></code>, based on the work of Lu (2005)</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of rsmatch from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rsmatch"</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, you can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"skent259/rsmatch"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-usage">Example usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h2>
<p>Consider the <code>oasis</code> data which consists of 51 patients from the <a href="https://www.oasis-brains.org/" class="external-link">Open Access Series of Imaging Studies</a> that are classified at each time point as having Alzheimer’s disease (AD) or not. We can match subjects who are similar in their gender, education level, socioeconomic status, age, and other MRI measurements, but one of which moved from a cognitively normal state to AD in the next time period and the other who remained cognitively normal.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://skent259.github.io/rsmatch/">rsmatch</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oasis</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/brsmatch.html">brsmatch</a></span><span class="op">(</span></span>
<span>  n_pairs <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  data <span class="op">=</span> <span class="va">oasis</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"subject_id"</span>, time <span class="op">=</span> <span class="st">"visit"</span>, trt_time <span class="op">=</span> <span class="st">"time_of_ad"</span>,</span>
<span>  balance <span class="op">=</span> <span class="cn">TRUE</span>, balance_covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m_f"</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">)</span></span>
<span><span class="co">#&gt;    subject_id pair_id type</span></span>
<span><span class="co">#&gt; 5   OAS2_0014       1  trt</span></span>
<span><span class="co">#&gt; 15  OAS2_0043       2  all</span></span>
<span><span class="co">#&gt; 22  OAS2_0079       2  trt</span></span>
<span><span class="co">#&gt; 32  OAS2_0112       3  all</span></span>
<span><span class="co">#&gt; 36  OAS2_0124       1  all</span></span>
<span><span class="co">#&gt; 40  OAS2_0140       5  all</span></span>
<span><span class="co">#&gt; 41  OAS2_0150       3  trt</span></span>
<span><span class="co">#&gt; 43  OAS2_0160       4  trt</span></span>
<span><span class="co">#&gt; 49  OAS2_0182       4  all</span></span>
<span><span class="co">#&gt; 50  OAS2_0184       5  trt</span></span></code></pre></div>
<p>These 10 subjects form the 5 best pairs according to balanced risk set matching, where we consider pairs close if they have similar covariates and we try to find balance on gender and age. We can see that the first pair match closely on their covariates:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_pair</span> <span class="op">&lt;-</span> <span class="va">pairs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">$</span><span class="va">pair_id</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, <span class="st">"subject_id"</span><span class="op">]</span></span>
<span><span class="va">oasis</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">oasis</span><span class="op">$</span><span class="va">subject_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">first_pair</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;    subject_id visit time_of_ad m_f educ ses age mr_delay e_tiv n_wbv   asf</span></span>
<span><span class="co">#&gt; 11  OAS2_0014     1          2   M   16   3  76        0  1602 0.697 1.096</span></span>
<span><span class="co">#&gt; 12  OAS2_0014     2          2   M   16   3  77      504  1590 0.696 1.104</span></span>
<span><span class="co">#&gt; 80  OAS2_0124     1         NA   M   16   3  70        0  1463 0.749 1.200</span></span>
<span><span class="co">#&gt; 81  OAS2_0124     2         NA   M   16   3  71      472  1479 0.750 1.187</span></span></code></pre></div>
<p>We can also find matches using Propensity Score Matching with Time-Dependent Covariates by Lu (2005)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/coxpsmatch.html">coxpsmatch</a></span><span class="op">(</span></span>
<span>  n_pairs <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  data <span class="op">=</span> <span class="va">oasis</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"subject_id"</span>, time <span class="op">=</span> <span class="st">"visit"</span>, trt_time <span class="op">=</span> <span class="st">"time_of_ad"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">first_pair</span> <span class="op">&lt;-</span> <span class="va">pairs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">pairs</span><span class="op">$</span><span class="va">pair_id</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, <span class="st">"subject_id"</span><span class="op">]</span></span>
<span><span class="va">oasis</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">oasis</span><span class="op">$</span><span class="va">subject_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">first_pair</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 11</span></span>
<span><span class="co">#&gt;   subject_id visit time_of_ad m_f    educ ses     age mr_delay e_tiv n_wbv   asf</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;int&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;fct&gt; &lt;int&gt;    &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 OAS2_0009      1         NA M        12 2        68        0  1457 0.806  1.20</span></span>
<span><span class="co">#&gt; 2 OAS2_0009      2         NA M        12 2        69      576  1480 0.791  1.19</span></span>
<span><span class="co">#&gt; 3 OAS2_0046      1          2 F        15 2        83        0  1476 0.75   1.19</span></span>
<span><span class="co">#&gt; 4 OAS2_0046      2          2 F        15 2        85      575  1483 0.748  1.18</span></span></code></pre></div>
<p>This picks a different first pair, but they are also close in covariates.</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>To cite package ‘rsmatch’ in publications use:</p>
<p>Kent S, Paukner M (2023). <em>rsmatch: Matching Methods for Time-varying Observational Studies</em>. R package version 0.2.0, <a href="https://github.com/skent259/rsmatch" class="external-link uri">https://github.com/skent259/rsmatch</a>.</p>
<p>A BibTeX entry for LaTeX users is</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bibtex"><code class="sourceCode bibtex"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="va">@Manual</span>{,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">title</span> = {rsmatch: Matching Methods for Time-varying Observational Studies},</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">author</span> = {Sean Kent and Mitchell Paukner},</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">year</span> = {2023},</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">note</span> = {R package version 0.2.0},</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">url</span> = {https://github.com/skent259/rsmatch},</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Li, Yunfei Paul, Kathleen J Propert, and Paul R Rosenbaum. 2001. “Balanced Risk Set Matching.” Journal of the American Statistical Association 96 (455): 870–82.</p>
<p>Lu, Bo. 2005. “Propensity Score Matching with Time-Dependent Covariates.” Biometrics 61 (3): 721–28.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=rsmatch" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/skent259/rsmatch/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/skent259/rsmatch/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rsmatch</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/skent259" class="external-link">Sean Kent</a> <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0001-8697-9069" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Mitchell Paukner <br><small class="roles"> Author, copyright holder </small> <a href="https://orcid.org/0000-0003-3839-5311" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=rsmatch" class="external-link"><img src="https://www.r-pkg.org/badges/version/rsmatch" alt="CRAN status"></a></li>
<li><a href="https://github.com/skent259/rsmatch/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/skent259/rsmatch/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/skent259" class="external-link">Sean Kent</a>, Mitchell Paukner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
